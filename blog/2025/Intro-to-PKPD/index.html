<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Basic Concepts in Population Modeling, Simulation, and Model-Based Drug Development: Part 1 | Laurent MacKay </title> <meta name="author" content="Laurent MacKay"> <meta name="description" content="Easing into PKPD modelling and R programming"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://laurentmackay.github.io/blog/2025/Intro-to-PKPD/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Laurent</span> MacKay </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/books/">bookshelf</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Basic Concepts in Population Modeling, Simulation, and Model-Based Drug Development: Part 1</h1> <p class="post-meta"> Created on April 13, 2025 by Laurent MacKay </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/dynamics"> <i class="fa-solid fa-hashtag fa-sm"></i> dynamics</a>   ·   <a href="/blog/category/pkpd"> <i class="fa-solid fa-tag fa-sm"></i> PKPD</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>The purpose of this document is to summarize the ideas from the <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC3606044/" title="Paper by Mould and Upton" rel="external nofollow noopener" target="_blank">titular paper</a> and gain experience with the fundamentals of pharmacokinetics in the R programming language. Also, some of the examples which were lacking in detail have been fleshed out for a clearer presentation.</p> <h2 id="basic-definitions--history">Basic Definitions + History</h2> <p><em>Pharmacokinetics (PK)</em><br> Studying the relationships between the <strong>physiological characteristics of an individual and observed drug exposure or response</strong>.</p> <ul> <li>This should be done in a way that accounts for between-subject-variability (BSV) by considering population-level parameter value distributions. <ul> <li>Initially two approaches were taken (i) combining all the data from individuals (the “naive pooled approach”), or (ii) by fitting all individuals separately and taking parameter means (the “two-stage approach”). Both approaches becoming increasingly problematic as the data collection becomes sparser and sloppier (i.e., real-world data).</li> <li>A more accurate approach was taken by Sheiner <em>et al. 1972</em> by accounting for BSV through the covariance of model parameters. This can yield informed estimates of the variability of drug exposure with age and weight as well as within the general populations.</li> <li>Such information is critical to “inform the initial selection of doses to test, modify or personalize dosage for subpopulations of patients, and evaluate the the appropriateness of study designs.”</li> </ul> </li> </ul> <p><em>Pharmacodynamics (PD)</em><br> Studying the relationship between <strong>drug concentration, including its intrinsic dynamics, and the observed physiological response</strong>.</p> <p><em>Model</em><br> A simplified <strong>representations of a system designed to provide knowledge or understanding</strong> of the system.</p> <ul> <li> <p>“All models are wrong, some are useful”.</p> <ul> <li> <p>A <strong>credible</strong> and high-<strong>fidelity</strong> choice of specific model for a specific purpose requires that it justified and defendable.</p> <ul> <li> <p>“<strong>Credible</strong> models are ones for which the assumptions made in the construction are understood and clearly stated”</p> </li> <li> <p>“<strong>Fidelity</strong> is gauged by comparing the model to components of the system (reality) that are considered important (note that fidelity does not always imply credibility)”</p> </li> </ul> </li> <li> <p>Model development should involve ranking credible models according to their fidelity.</p> </li> </ul> </li> </ul> <h3 id="summary">Summary:</h3> <blockquote> <div> PK Models - How long does a drug stay in the body? How does that vary within a population? </div> </blockquote> <blockquote> <div> PD Models - What does a drug do while it is in the body? </div> </blockquote> <p>PK models should</p> <ul> <li> <p>“provide a basis for describing and understanding the <strong>time-course of drug exposure and response after the administration of different doses or formulations</strong> of a drug to individuals”</p> </li> <li> <p>“provide a means for <strong>estimating the associated parameters such as clearance and volume of distribution of a drug”</strong></p> <ul> <li>“Population models should yield parameter estimates which can be <strong>compared to previous assessments to determine consistency between studies or patient populations</strong>.”</li> </ul> </li> </ul> <p>The data that is used in model parametertizaton can also be <strong>compared with those relating to other drugs in the same therapeutic class</strong>, as a means of evaluating the development potential of a new therapeutic agent.</p> <p><em>PK models</em></p> <ul> <li> <p>Usually built from interconnected “compartments” where the concentration is assumed to be uniform and the drug may move from one compartment to the other.</p> <ul> <li> <p>Physiology-based PK models (PBPK) have compartments that map onto anatomically defined parts of the body (e.g., organs, blood, connective tissue).</p> </li> <li> <p>PBPK models often have more compartments, which makes parameter estimation more difficult in clinical setting. However they can yield more insight into how physiological perturbations and disease might influence drug distribution, this can be useful in translating findings from preclinical to clinical settings</p> </li> </ul> </li> </ul> <p><em>PKPD Models</em></p> <p>These model additionally include a model of the effects of the drug, which is critical in predicting clinical outcomes. Developing a PD model requires knowledge of the concentration-effect relationship and choice of a typical effect size for a “successful” treatment. Then, using the population-level PK model, we can determine a probability of success within a cohort.</p> <ul> <li>“Exposure–response models are a class of PKPD models wherein the independent variable is not time, but rather, a metric describing drug exposure at steady-state (e.g., dose, area under the curve ($\text{A.U.C}$), or peak plasma concentration ($C_{\text{max}}$)).”</li> </ul> <p><em>Disease progression models</em></p> <p>Describe the time course of a diseases evolution and account for BSV in disease progression, crucially these must be developed from a placebo group. They can then be linked to PD/PKPD to determine the efficacy of drug treatment.</p> <p><em>Meta-models</em></p> <p>Meaning “the analysis of analyses”, these are analyses of aggregated results from many individual studies that are critical for decision making purposes. Their implementation is non-trivial due a variety of considerations related to study and model design.</p> <p><em>Bayesian Averaging</em></p> <p>Bayesian approaches are very useful for model selection when multiple models exist and there is uncertainty about which might be best suited.</p> <h1 id="some-examples-of-population-models">Some Examples of Population Models</h1> <h2 id="preliminaries">Preliminaries</h2> <p>The three main components of population models are:</p> <ol> <li> <p><strong><em>Structural Models</em></strong> - functions that describe the time course of a measured response, which can be represented implicitly as algebraic or differential equations.</p> </li> <li> <p><strong><em>Stochastic Models</em></strong> - descriptions of the variability or random effects in the observed data</p> </li> <li> <p><strong><em>Covariate Models</em></strong> - descriptions of the influence of factors such as demographics or disease on the individual time course of the response</p> </li> </ol> <p>A model can only be as good as the data it was fit to. Data coming from clinical trials can be very heterogeneous in quality, sampling frequency, and units. These all introduce non-negligible challenges for fitting PK model in a high quality manner.</p> <h2 id="models">Models</h2> <h3 id="structural-models">Structural Models</h3> <p>The simplest PK model is arguably a one-compartment model where a single dose of drug is administered intravenously to a compartment with volume $V$. The time-dependent concentration of drug, $C(t)$, can be expressed as either a differential equation or algebraic equation. That is</p> \[\dfrac{d}{dt}C=-kC \qquad \text{ with }\quad C(0)=\frac{\text{dose}}{V} \qquad \Leftrightarrow \qquad C(t)=\frac{\text{dose}}{V}e^{-kt},\quad\quad \quad (1)\] <p>where $k&gt;0$ is the clearance rate of the drug from the “body” compartment. In the differential equation, time is unambiguously the independent variable. However, once it is solved and we have the algebraic expression it is also possible to vary any of the model parameters at some fixed time and ask how some model outcome varies.</p> <p>Because this is a linear ODE, if multiple doses are administered at a set of times ${t_j}$ then we may exploit the superposition of solutions to obtain</p> \[C(t)=\sum_{j \text{ with } t_j \geq t} \frac{\text{dose}}{V}e^{-k(t-t_j)},\] <p>or, more generally, for a generic time-dependent dose delivery regimen, $\text{dose}(t)$, we may use the convolution theorem to obtain</p> \[C(t)=\frac{e^{-kt}}{V} \ast \text{dose}(t)=\int_0^t\frac{e^{-k(t-\tau)}}{V} \text{dose}(\tau) d\tau = \int_0^t\frac{e^{-k\tau}}{V} \text{dose}(t-\tau) d\tau,\] <p>where discrete injections could be modeled as Dirac delta functions.</p> <h3 id="stochastic-models">Stochastic Models</h3> <p>Population models can account for a drug’s BSV and between-occasion variability. We can write down a simple formalism to describe this variability as a random parameter $p$ consisting of the sum of a population mean $\theta$ and a random effect $\eta$, i.e.,</p> \[p = \theta+\eta \quad\text{with}\quad \mathbb{E}[\eta]=0, \text{ and } \mathbb{E}[\eta^2]=\omega\] <p>where $\eta$ is assumed to have zero mean and variance $\omega$ (and is often assumed to be normally or log-normally distributed).</p> <p>Accounting for such variability is is critical for determining the suitability of a drug for therapeutic purposes. For example, a drug with narrow therapeutic window but large variability would not be a good candidate for bringing to market as it is likely that few people would benefit from it.</p> <p>To get more concrete idea of what this might mean, we can generate an artificial population by modeling individuals as a one-compartment models. Lets assume that we can find a population of subjects that are uniformly distributed in age, with volume that is normally distributed (but the two different sexes are sampled from distributions with different means), and a clearance rate that is roughly normally distributed (independent of sex). Data for such a population is generated and its statistics are plotted in the code chunk below.</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#library(ggstats)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="c1">#library(dplyr)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggpubr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">latex2exp</span><span class="p">)</span><span class="w">

</span><span class="n">source</span><span class="p">(</span><span class="s1">'util.R'</span><span class="p">)</span><span class="w">

</span><span class="n">n</span><span class="o">&lt;</span><span class="m">-2e4</span><span class="w"> </span><span class="c1">#number of subjects</span><span class="w">

</span><span class="n">pop</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="w">
     </span><span class="c1">#roughly half females and males</span><span class="w">
     </span><span class="n">sex</span><span class="o">=</span><span class="n">factor</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="s2">"F"</span><span class="p">,</span><span class="w"> </span><span class="n">each</span><span class="o">=</span><span class="nf">floor</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="m">2</span><span class="p">)),</span><span class="nf">rep</span><span class="p">(</span><span class="s2">"M"</span><span class="p">,</span><span class="w"> </span><span class="n">each</span><span class="o">=</span><span class="nf">ceiling</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="m">2</span><span class="p">))</span><span class="w"> </span><span class="p">)),</span><span class="w">
     </span><span class="c1">#uniformly distributed ages 18-80 years old</span><span class="w">
     </span><span class="n">age</span><span class="o">=</span><span class="n">runif</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="m">18</span><span class="p">,</span><span class="m">80</span><span class="p">),</span><span class="w">
     </span><span class="c1">#assume males have 10 more volume units than females</span><span class="w">
     </span><span class="n">V</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="w">
       </span><span class="n">rnorm</span><span class="p">(</span><span class="nf">floor</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">mean</span><span class="o">=</span><span class="m">55</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="o">=</span><span class="m">5</span><span class="p">),</span><span class="w">
       </span><span class="n">rnorm</span><span class="p">(</span><span class="nf">ceiling</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">mean</span><span class="o">=</span><span class="m">65</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="o">=</span><span class="m">5</span><span class="p">)</span><span class="w">
       </span><span class="p">)</span><span class="w">
 </span><span class="p">)</span><span class="w">

</span><span class="c1">#clearance rate is normally-distributed with a mean that decreases with age - a covariate effect</span><span class="w">
</span><span class="n">pop</span><span class="o">$</span><span class="n">k</span><span class="o">=</span><span class="n">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="m">11.2-3.2</span><span class="o">*</span><span class="p">(</span><span class="n">pop</span><span class="o">$</span><span class="n">age</span><span class="m">-18</span><span class="p">)</span><span class="o">/</span><span class="m">62</span><span class="p">,</span><span class="w"> </span><span class="m">0.8</span><span class="p">)</span><span class="o">/</span><span class="m">1e2</span><span class="w">


</span><span class="n">captioned</span><span class="p">(</span><span class="n">plot_population_stats</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span><span class="w">  </span><span class="n">group</span><span class="o">=</span><span class="n">sex</span><span class="p">,</span><span class="w"> </span><span class="n">total_pop</span><span class="o">=</span><span class="nb">T</span><span class="p">,</span><span class="w"> </span><span class="n">group_means</span><span class="o">=</span><span class="nb">T</span><span class="p">),</span><span class="w"> 
          </span><span class="n">text</span><span class="o">=</span><span class="s2">"Figure 1. (A-D) Population statistics for simulated poplation data, separated by sex of the subjects. The dashed-dotted lines represent the distribution for the entire population."</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p><img src="/assets/img/mu_part1/unnamed-chunk-1-1.png" style="display: block; margin: auto;"></p> <p>Now, suppose a certain drug needs to be above a threshold concentration, $C_{\text{thresh}}$, to have an effect, but if its concentration remains too elevated for too long then it can start to cause negative side effects. Using the one-compartment model we can compute the time it takes for the concentration to fall below $C_{\text{thresh}}$, this is given by the expression</p> \[t_{thresh}=\max\left(\frac{\log\left( \frac{\text{dose}}{C_{\text{thresh}} V} \right)}{k},0\right)\] <p>where the max operation is use to account for scenarios where the initial concentration is already below $C_{\text{thresh}}$. Then we can quantify the extent to which concentration is elevated using the area under the curve, $\text{A.U.C.}$, which accounts for both the amount of time a drug has non-negligible concentration as well as how high the concentration is. For the one-compartment model, this can be computed as</p> \[A.U.C.(t)= \frac{\text{dose}}{V} \intop_0^t e^{-ks}ds=\frac{\text{dose}}{V} \frac{1-e^{-kt}}{k},\] <p>where we note that $\lim_{t\to\infty}A.U.C(t)=\frac{\text{dose}}{V} \frac{1}{k}$. As a simple example, we assume that in order to generate therapeutic benefit we need $A.U.C(t_{thresh})$ greater than some threshold while also having $A.U.C(\infty)$ less than another threshold, which we denote as the <strong>therapeutic window</strong> of the drug in this scenario.</p> <p>In the code chunk below, we compute these $A.U.C.$ values for our simulated population and then assess what proportion of the population receives a therapeutically “successful” treatment (i.e., with $A.U.C(t_{thresh})$ large enough for therapeutic benefit but with $A.U.C.(\infty)$ not too large to cause significant side effects). As we can see from the figure, by simply using the population averaged PK parameters we predict a successful treatment whereas accounting for the variability in volume and clearance rate we can see a more nuanced picture where treatment is successful for approximately 60% (90%) of females (males) in the population. These population-dependent predictions are completely missed if the stochastic nature of BSV is not accounted for.</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">source</span><span class="p">(</span><span class="s1">'one_compartment.R'</span><span class="p">)</span><span class="w">
</span><span class="n">C_thresh</span><span class="o">&lt;</span><span class="m">-0.01</span><span class="w">

</span><span class="n">side_effects_thresh</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.2</span><span class="w">
</span><span class="n">therapeutic_thresh</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.03</span><span class="w">


</span><span class="c1">#compute AUC for t=infinity and t=t_thresh</span><span class="w">
</span><span class="n">pop_dosage</span><span class="o">&lt;-</span><span class="n">compute_AUCs</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span><span class="w"> </span><span class="n">C_thresh</span><span class="p">)</span><span class="w">




</span><span class="n">plot</span><span class="o">&lt;-</span><span class="n">ggplot</span><span class="p">(</span><span class="n">pop_dosage</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">auc_infinity</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">auc_thresh</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="n">sex</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">annotate</span><span class="p">(</span><span class="s2">"rect"</span><span class="p">,</span><span class="w"> </span><span class="n">xmin</span><span class="o">=-</span><span class="kc">Inf</span><span class="p">,</span><span class="w"> </span><span class="n">xmax</span><span class="o">=</span><span class="n">side_effects_thresh</span><span class="p">,</span><span class="w"> </span><span class="n">ymin</span><span class="o">=</span><span class="n">therapeutic_thresh</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="o">=</span><span class="kc">Inf</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="s2">"grey"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">annotate</span><span class="p">(</span><span class="s2">"text"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.42</span><span class="o">*</span><span class="p">(</span><span class="n">side_effects_thresh</span><span class="o">-</span><span class="nf">min</span><span class="p">(</span><span class="n">pop_dosage</span><span class="o">$</span><span class="n">auc_infinity</span><span class="p">))</span><span class="o">+</span><span class="nf">min</span><span class="p">(</span><span class="n">pop_dosage</span><span class="o">$</span><span class="n">auc_infinity</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w">
           </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="o">*</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">pop_dosage</span><span class="o">$</span><span class="n">auc_thresh</span><span class="p">)</span><span class="o">-</span><span class="nf">min</span><span class="p">(</span><span class="n">pop_dosage</span><span class="o">$</span><span class="n">auc_thresh</span><span class="p">))</span><span class="o">+</span><span class="nf">min</span><span class="p">(</span><span class="n">pop_dosage</span><span class="o">$</span><span class="n">auc_thresh</span><span class="p">),</span><span class="w">
           </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Therapeutic Window"</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s2">"white"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">7</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="nf">min</span><span class="p">(</span><span class="m">2e3</span><span class="o">/</span><span class="n">n</span><span class="p">,</span><span class="m">1</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">filtered_stats_in_legend</span><span class="p">(</span><span class="n">pop_dosage</span><span class="p">,</span><span class="w"> </span><span class="n">cond</span><span class="o">=</span><span class="n">auc_infinity</span><span class="o">&lt;</span><span class="n">side_effects_thresh</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">auc_thresh</span><span class="o">&gt;</span><span class="n">therapeutic_thresh</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="o">=</span><span class="n">sex</span><span class="p">,</span><span class="w">
                           </span><span class="n">scale</span><span class="o">=</span><span class="n">scale_color_discrete</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">guides</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guide_legend</span><span class="p">(</span><span class="n">override.aes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">+</span><span class="w">
 </span><span class="n">geom_cross_line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">side_effects_thresh</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">therapeutic_thresh</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s2">"dotted"</span><span class="p">,</span><span class="w">
                 </span><span class="n">linewidth</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">show.legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">,</span><span class="w">  </span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">)</span><span class="o">+</span><span class="w">
 </span><span class="n">average_geom_point</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span><span class="w"> </span><span class="n">post_process</span><span class="o">=</span><span class="k">function</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="w"> </span><span class="n">compute_AUCs</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">C_thresh</span><span class="p">),</span><span class="w">
                </span><span class="n">fill</span><span class="o">=</span><span class="k">function</span><span class="p">(</span><span class="n">average</span><span class="p">)</span><span class="w">
                  </span><span class="n">ifelse</span><span class="p">(</span><span class="n">with</span><span class="p">(</span><span class="n">average</span><span class="p">,</span><span class="w"> </span><span class="n">auc_infinity</span><span class="o">&lt;</span><span class="n">side_effects_thresh</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">auc_thresh</span><span class="o">&gt;</span><span class="n">therapeutic_thresh</span><span class="p">),</span><span class="w">
                  </span><span class="s2">"successful treatment"</span><span class="p">,</span><span class="w"> </span><span class="s2">"failed treatment"</span><span class="p">)</span><span class="w">
                </span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="m">8</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">TeX</span><span class="p">(</span><span class="s2">"$A.U.C.(\\infty)$"</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">TeX</span><span class="p">(</span><span class="s2">"$A.U.C(t_{thresh})$"</span><span class="p">))</span><span class="w">


</span><span class="c1">#generate scatter plot</span><span class="w">
</span><span class="n">captioned</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span><span class="w">
</span><span class="n">text</span><span class="o">=</span><span class="s2">"Figure 2. Scatter plot showing how much of the population is inside the therapeutic window (grey square in top left). Notice that almost all male subjects fall within the therapeutic window, while a significant portion of the female subjects are outside of it. Meanwhile, the population averaged parameters result in a treatment that is within the therapeutic window. Together, these examples highlight how conclusions are affected by either not separating data into different population groups or prematurely averaging."</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">1</span><span class="p">))</span><span class="w">
</span></code></pre></div></div> <p><img src="/assets/img/mu_part1/unnamed-chunk-2-1.png" style="display: block; margin: auto;"></p> <h3 id="covariate-models">Covariate Models</h3> <p>If you looked carefully in the first code chunk you may have noticed that we made clearance rate depend linearly on the age of an individual. This is an example of a covariate population model, where the random value of different parameters are correlated. In this specific instance, we have chosen</p> \[k=m\cdot\text{age}+b+\eta \quad\quad \text{with} \quad \eta \sim \mathcal{N}(0,6.4\times10^{-5})\] <p>where $m$ and $b$ are constants and $\eta$ is normally distributed random effect with a variance of $6.4\times10^{-5}$ (see the Fig. 3A for illustration).</p> <p>More generally, a correlation between the $\text{i}^\text{th}$ and $\text{j}^\text{th}$ random parameters can be expressed by a formalism given by</p> \[\begin{align*} p_i&amp;=\theta_j+g_{i}(X_1, X_2, \dots,X_n)\\ p_j&amp;=\theta_i+g_{j}(X_1, X_2, \dots,X_n) \end{align*}\] <p>where $\theta_i$ &amp; $\theta_j$ are the population means as before, $g_i$ &amp; $g_j$ are multi-dimensional functions, and the values $X_k$ are covariate random variables (i.e., random variables that allow the parameter values to have some degree of dependence on one another). For the previous example, this formalism reduces to</p> \[\begin{align*} \text{age}&amp;=49+31X_1 &amp;\Rightarrow g_{\text{age}}(X_1)&amp;=31 X_1 \quad \text{with}\quad X_1\sim\mathcal{U}_{[-1,1]}\\ \text{and} \qquad k&amp;=.112-.032\frac{(\text{age}-18)}{62}+0.008X_2&amp;\text{with} \quad X_2\sim\mathcal{N}(0,1) \\&amp;=0.097-\frac{0.032}2 X_1 +0.008X_2&amp;\Rightarrow g_{k}(X_1,X_2)&amp;=-0.016X_1+0.008X_2. \end{align*}\] <p>We note that this example uses linear functions for $g_{\text{age}}$ and $g_k$, but in general this need not be the case.</p> <p>Covariance between parameters can have profound implications for therapeutic outcomes of a drug within sub-populations (e.g., people with certain conditions, within different age ranges, or living specific lifestyles). In our previous example clearance decreases with age, which accordingly results longer-lasting concentration levels of drug concentration to the one-compartment model makes consider how</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">source</span><span class="p">(</span><span class="s1">'one_compartment.R'</span><span class="p">)</span><span class="w">
</span><span class="n">source</span><span class="p">(</span><span class="s1">'util.R'</span><span class="p">)</span><span class="w">

</span><span class="n">p1</span><span class="o">&lt;-</span><span class="n">ggplot</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">k</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">stroke</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="nf">min</span><span class="p">(</span><span class="m">5e2</span><span class="o">/</span><span class="n">n</span><span class="p">,</span><span class="m">.2</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="o">~</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s1">'lm'</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span><span class="n">linetype</span><span class="o">=</span><span class="m">6</span><span class="p">)</span><span class="w">

</span><span class="n">age_thresh</span><span class="o">&lt;</span><span class="m">-45</span><span class="w">
</span><span class="n">pop_dosage</span><span class="o">$</span><span class="n">age_group</span><span class="o">=</span><span class="n">factor</span><span class="p">(</span><span class="n">sapply</span><span class="p">(</span><span class="n">pop_dosage</span><span class="o">$</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">age</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">age</span><span class="o">&gt;</span><span class="n">age_thresh</span><span class="p">){</span><span class="s2">"elderly"</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="s2">"young"</span><span class="p">}))</span><span class="w">





</span><span class="n">sub_pop_timeseries</span><span class="o">&lt;-</span><span class="n">bind_with</span><span class="p">(</span><span class="n">sub_sample</span><span class="p">(</span><span class="n">pop_dosage</span><span class="p">,</span><span class="w"> </span><span class="m">30</span><span class="p">),</span><span class="w"> 
                              </span><span class="n">mutate</span><span class="p">(</span><span class="n">concentration_sample</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="n">t_sample</span><span class="o">=</span><span class="nf">cumsum</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">20</span><span class="p">,</span><span class="n">runif</span><span class="p">(</span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">)))),</span><span class="w">
                                     </span><span class="n">age_group</span><span class="o">=</span><span class="n">age_group</span><span class="p">),</span><span class="w">
                               </span><span class="n">.id</span><span class="o">=</span><span class="s2">"id"</span><span class="p">)</span><span class="w">


</span><span class="n">p2</span><span class="o">&lt;-</span><span class="n">ggplot</span><span class="p">(</span><span class="n">sub_pop_timeseries</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">concentration</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="n">age_group</span><span class="p">),</span><span class="w"> </span><span class="n">log10</span><span class="o">=</span><span class="s2">"y"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">()</span><span class="o">+</span><span class="w"> </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">trans</span><span class="o">=</span><span class="s1">'log10'</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_smooth_group_and_mean</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"lm"</span><span class="p">,</span><span class="w"> </span><span class="n">se</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">show.legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">TeX</span><span class="p">(</span><span class="s2">"concetration ($\\log_{10}$)"</span><span class="p">),</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="s2">"time (hours)"</span><span class="p">)</span><span class="w">



</span><span class="n">AUC_by_age_group</span><span class="o">&lt;-</span><span class="n">summarise</span><span class="p">(</span><span class="n">group_by</span><span class="p">(</span><span class="n">pop_dosage</span><span class="p">,</span><span class="n">age_group</span><span class="p">),</span><span class="w"> </span><span class="n">mean</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="n">auc_infinity</span><span class="p">))</span><span class="w">
</span><span class="n">adjusted_dose</span><span class="o">&lt;-</span><span class="n">with</span><span class="p">(</span><span class="n">AUC_by_age_group</span><span class="p">,</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span><span class="o">/</span><span class="nf">max</span><span class="p">(</span><span class="n">mean</span><span class="p">))</span><span class="w">

</span><span class="n">pop_adjusted_dosage</span><span class="o">&lt;-</span><span class="n">data.frame</span><span class="p">(</span><span class="n">pop_dosage</span><span class="p">)</span><span class="w">

</span><span class="n">inds</span><span class="o">&lt;-</span><span class="n">which</span><span class="p">(</span><span class="n">pop_dosage</span><span class="o">$</span><span class="n">age_group</span><span class="o">==</span><span class="s2">"elderly"</span><span class="p">)</span><span class="w">

</span><span class="n">pop_adjusted_dosage</span><span class="p">[</span><span class="n">inds</span><span class="p">,]</span><span class="o">&lt;-</span><span class="n">compute_AUCs</span><span class="p">(</span><span class="n">pop_dosage</span><span class="p">[</span><span class="n">inds</span><span class="p">,],</span><span class="w"> </span><span class="n">C_thresh</span><span class="p">,</span><span class="w"> </span><span class="n">dose</span><span class="o">=</span><span class="n">adjusted_dose</span><span class="p">)</span><span class="w">



</span><span class="n">p34</span><span class="o">&lt;-</span><span class="n">lapply</span><span class="p">(</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">pop_dosage</span><span class="p">,</span><span class="w"> </span><span class="n">pop_adjusted_dosage</span><span class="p">),</span><span class="w"> 
             </span><span class="k">function</span><span class="p">(</span><span class="n">data</span><span class="p">){</span><span class="w">

                </span><span class="n">plot_population_stats</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">column</span><span class="o">=</span><span class="n">auc_infinity</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="o">=</span><span class="n">age_group</span><span class="p">,</span><span class="w">
                                      </span><span class="n">group_means</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">stats_in_label</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w">
                                      </span><span class="n">x_label</span><span class="o">=</span><span class="n">TeX</span><span class="p">(</span><span class="s2">"$A.U.C.(\\infty)$"</span><span class="p">),</span><span class="w"> </span><span class="n">margin</span><span class="o">=</span><span class="n">unit</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="s1">'cm'</span><span class="p">))</span><span class="o">+</span><span class="w">
                   </span><span class="n">filtered_stats_in_legend</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">cond</span><span class="o">=</span><span class="n">auc_infinity</span><span class="o">&gt;=</span><span class="n">side_effects_thresh</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="o">=</span><span class="n">age_group</span><span class="p">,</span><span class="w">
                                          </span><span class="n">success_string</span><span class="o">=</span><span class="s2">"%s (%0.1f%% experience side-effects)"</span><span class="p">)</span><span class="o">+</span><span class="w">
                   </span><span class="n">guides</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">guide_legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">title.position</span><span class="o">=</span><span class="s2">"top"</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="o">=</span><span class="s2">"bottom"</span><span class="p">))</span><span class="w">

          </span><span class="p">})</span><span class="w">

</span><span class="n">captioned</span><span class="p">(</span><span class="w">
          
          </span><span class="n">ggarrange</span><span class="p">(</span><span class="n">plotlist</span><span class="o">=</span><span class="n">lapply</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">),</span><span class="n">p34</span><span class="p">),</span><span class="w">
                                    </span><span class="k">function</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="n">p</span><span class="o">+</span><span class="n">theme</span><span class="p">(</span><span class="n">plot.margin</span><span class="o">=</span><span class="n">unit</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0.4</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0.6</span><span class="p">,</span><span class="m">0.4</span><span class="p">),</span><span class="w"> </span><span class="s1">'cm'</span><span class="p">),</span><span class="w">
                                                        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">
                                    </span><span class="p">),</span><span class="w">
                    </span><span class="n">nrow</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">align</span><span class="o">=</span><span class="s1">'v'</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="s2">"AUTO"</span><span class="p">,</span><span class="w"> </span><span class="n">vjust</span><span class="o">=</span><span class="m">-0.13</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">-1.25</span><span class="p">,</span><span class="w"> </span><span class="n">heights</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1.4</span><span class="p">)),</span><span class="w">
          
          </span><span class="n">text</span><span class="o">=</span><span class="s2">"Figure 3. (A) Dependence of clearance rate, k, with subject age, the dashed-dotted line is a line of best fit from data. (B) Time-dependence of simulated drug concentration, in log10-scale, for elderly and young individuals. Drug concentration is \"sampled\" (i.e., simulated) every 4-5 hours using Eq. (1) with multiplicative noise. Solid symbols indicate the \"measured\" data, dotted lines show a linear fit for each individual, and the solid line is a linear fit for all the data pooled together (i.e., the population average). (C&amp;D) Historgrams of the total area under the curve after a dose administration with (C) fixed dosage across age groups (D) and dosage adjusted for age groups."</span><span class="p">,</span><span class="w">
          </span><span class="n">heights</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="w">
          </span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p><img src="/assets/img/mu_part1/unnamed-chunk-3-1.png" style="display: block; margin: auto;"></p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Laurent MacKay. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>